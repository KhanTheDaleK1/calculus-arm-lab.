<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CalculusArm Lab v4.1</title>
    <link rel="stylesheet" href="css/style.css?v=1765825465">
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="js/stk500.js?v=1765825465"></script>
</head>
<body>
    <div class="app-container">
        <header>
            <h1>CalculusArm <span class="highlight">Dynamics Lab</span></h1>
            <div class="connection-status">
                <select id="serial-port-list" class="port-dropdown"><option value="prompt">üîå Add New Device...</option></select>
                <button id="btn-open-port" class="btn primary">Connect</button>
                <button id="btn-flash" class="btn action">‚ö° Flash Firmware</button>
                <span id="status-indicator" class="status disconnected">Disconnected</span>
            </div>
        </header>

        <main class="grid-layout">
            <section class="panel control-panel">
                <h2>1. Configuration Space ($\mathcal{C}$)</h2>
                <p style="font-size: 0.8rem; color: #888;">State Vector $\mathbf{q} = [\theta_1, \theta_2, \theta_3]^T$</p>
                
                <div class="slider-group">
                    <label>Base ($\theta_1$) <span class="val-display"><span id="val-theta1-deg">90¬∞</span> / <span id="val-theta1-rad" style="color:#00ff9d;">1.57rad</span></span></label>
                    <input type="range" id="slider-theta1" min="0" max="180" value="90">
                </div>
                <div class="slider-group">
                    <label>Shoulder ($\theta_2$) <span class="val-display"><span id="val-theta2-deg">90¬∞</span> / <span id="val-theta2-rad" style="color:#00ff9d;">1.57rad</span></span></label>
                    <input type="range" id="slider-theta2" min="0" max="180" value="90">
                </div>
                <div class="slider-group">
                    <label>Elbow ($\theta_3$) <span class="val-display"><span id="val-theta3-deg">90¬∞</span> / <span id="val-theta3-rad" style="color:#00ff9d;">1.57rad</span></span></label>
                    <input type="range" id="slider-theta3" min="0" max="180" value="90">
                </div>
                
                <div class="help-box" style="margin-top:20px; font-size: 0.75rem; color: #666; border-top: 1px dashed #444; padding-top:10px;">
                    <p><strong>Note:</strong> Servo hardware operates in Degrees.<br>Calculus operations use Radians.</p>
                </div>
            </section>

            <section class="panel vis-panel">
                <h2>2. Task Space Trajectory ($\mathbb{R}^3$)</h2>
                <div id="plot-container" style="width:100%; height:400px; background:#121212;"></div>
                <div class="plot-controls">
                    <button id="btn-record" class="btn action">üî¥ Record Motion</button>
                    <button id="btn-clear" class="btn action">üóëÔ∏è Clear Graph</button>
                </div>
            </section>

            <section class="panel math-panel">
                <h2>3. Kinematics Analysis</h2>
                
                <div class="math-module">
                    <h3>Forward Kinematics (\mathbf{q})$</h3>
                    <p>Position Vector $\mathbf{x} = \langle x, y, z \rangle$</p>
                    <div class="readout-grid" style="font-family: monospace;">
                        <div>x: <span id="out-x" style="color: #ff4757;">0.00</span> cm</div>
                        <div>y: <span id="out-y" style="color: #2ed573;">0.00</span> cm</div>
                        <div>z: <span id="out-z" style="color: #1e90ff;">0.00</span> cm</div>
                    </div>
                </div>

                <div class="math-module">
                    <h3>Velocity Vector $\mathbf{v}$</h3>
                    <p>$\mathbf{v} = \frac{d\mathbf{x}}{dt} = \langle v_x, v_y, v_z \rangle$</p>
                    <div class="readout-grid" style="font-family: monospace; font-size: 0.9rem; color: #aaa;">
                        <div>$: <span id="vel-x">0.00</span></div>
                        <div>$: <span id="vel-y">0.00</span></div>
                        <div>$: <span id="vel-z">0.00</span></div>
                    </div>
                    <hr style="border: 0; border-top: 1px dashed #444; margin: 8px 0;">
                    <p><strong>Speed (Scalar):</strong> $\|\mathbf{v}\| = \sqrt{v_x^2 + v_y^2 + v_z^2}$</p>
                    <div id="math-speed" class="big-number">0.00 <span style="font-size:0.5em">cm/s</span></div>
                </div>

                <div class="math-module">
                    <h3>Local Linear Approximation</h3>
                    <p>Linear regression over $\Delta t \approx 1s$:</p>
                    <div style="font-family: monospace; font-size: 0.9rem; line-height: 1.4;">
                        <div id="func-x" style="color:#ff4757;">x(t) ‚âà --</div>
                        <div id="func-y" style="color:#2ed573;">y(t) ‚âà --</div>
                        <div id="func-z" style="color:#1e90ff;">z(t) ‚âà --</div>
                    </div>
                </div>
            </section>
        </main>

        <section class="system-log" style="background:#000; color:#0f0; font-family:monospace; padding:10px; height:100px; overflow-y:scroll; border-top:1px solid #333;">
            <div id="log-output">System Ready. Forward Kinematics Engine Online.</div>
        </section>
    </div>
    
    <script src="js/app.js?v=1765825465"></script>
</body>
</html>
